<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>12.3 Count Regression Models | Data Analysis for Public Affairs with R</title>
  <meta name="description" content="12.3 Count Regression Models | Data Analysis for Public Affairs with R" />
  <meta name="generator" content="bookdown 0.23 and GitBook 2.6.7" />

  <meta property="og:title" content="12.3 Count Regression Models | Data Analysis for Public Affairs with R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="12.3 Count Regression Models | Data Analysis for Public Affairs with R" />
  
  
  

<meta name="author" content="Jerome Dumortier" />


<meta name="date" content="2021-09-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="censoring.html"/>
<link rel="next" href="hurdle-and-zero-inflation-models.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="chapter" data-level="2" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="overview.html"><a href="overview.html"><i class="fa fa-check"></i><b>2.1</b> Overview</a></li>
<li class="chapter" data-level="2.2" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html"><i class="fa fa-check"></i><b>2.2</b> R and RStudio</a><ul>
<li class="chapter" data-level="2.2.1" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#preparation-for-rrstudio"><i class="fa fa-check"></i><b>2.2.1</b> Preparation for R/RStudio</a></li>
<li class="chapter" data-level="2.2.2" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#installing-r-and-rstudio"><i class="fa fa-check"></i><b>2.2.2</b> Installing R and RStudio</a></li>
<li class="chapter" data-level="2.2.3" data-path="r-and-rstudio.html"><a href="r-and-rstudio.html#locating-files-on-your-computer"><i class="fa fa-check"></i><b>2.2.3</b> Locating Files on your Computer</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="introduction-to-r.html"><a href="introduction-to-r.html"><i class="fa fa-check"></i><b>3</b> Introduction to R</a><ul>
<li class="chapter" data-level="3.1" data-path="r-resources-and-help.html"><a href="r-resources-and-help.html"><i class="fa fa-check"></i><b>3.1</b> R Resources and Help</a></li>
<li class="chapter" data-level="3.2" data-path="opening-rstudio.html"><a href="opening-rstudio.html"><i class="fa fa-check"></i><b>3.2</b> Opening RStudio</a><ul>
<li class="chapter" data-level="3.2.1" data-path="opening-rstudio.html"><a href="opening-rstudio.html#in-class-exercise-1"><i class="fa fa-check"></i><b>3.2.1</b> In-class Exercise 1</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="functions.html"><a href="functions.html"><i class="fa fa-check"></i><b>3.3</b> Functions</a></li>
<li class="chapter" data-level="3.4" data-path="data-in-r.html"><a href="data-in-r.html"><i class="fa fa-check"></i><b>3.4</b> Data in R</a><ul>
<li class="chapter" data-level="3.4.1" data-path="data-in-r.html"><a href="data-in-r.html#using-r-as-a-calculator"><i class="fa fa-check"></i><b>3.4.1</b> Using R as a Calculator</a></li>
<li class="chapter" data-level="3.4.2" data-path="data-in-r.html"><a href="data-in-r.html#creating-a-data-frame-from-scratch"><i class="fa fa-check"></i><b>3.4.2</b> Creating a Data Frame from Scratch</a></li>
<li class="chapter" data-level="3.4.3" data-path="data-in-r.html"><a href="data-in-r.html#in-class-exercise-2"><i class="fa fa-check"></i><b>3.4.3</b> In-class Exercise 2</a></li>
<li class="chapter" data-level="3.4.4" data-path="data-in-r.html"><a href="data-in-r.html#indexing"><i class="fa fa-check"></i><b>3.4.4</b> Indexing</a></li>
<li class="chapter" data-level="3.4.5" data-path="data-in-r.html"><a href="data-in-r.html#importing-data-into-r"><i class="fa fa-check"></i><b>3.4.5</b> Importing Data into R</a></li>
<li class="chapter" data-level="3.4.6" data-path="data-in-r.html"><a href="data-in-r.html#sub-setting-a-data-frame"><i class="fa fa-check"></i><b>3.4.6</b> Sub-setting a Data Frame</a></li>
<li class="chapter" data-level="3.4.7" data-path="data-in-r.html"><a href="data-in-r.html#in-class-exercises-3"><i class="fa fa-check"></i><b>3.4.7</b> In-class Exercises 3</a></li>
<li class="chapter" data-level="3.4.8" data-path="data-in-r.html"><a href="data-in-r.html#aggregating-data"><i class="fa fa-check"></i><b>3.4.8</b> Aggregating Data</a></li>
<li class="chapter" data-level="3.4.9" data-path="data-in-r.html"><a href="data-in-r.html#writing-data-frame-to-.csv-file"><i class="fa fa-check"></i><b>3.4.9</b> Writing Data Frame to .csv-File</a></li>
<li class="chapter" data-level="3.4.10" data-path="data-in-r.html"><a href="data-in-r.html#reshaping-data-from-long-to-wide-and-viceversa"><i class="fa fa-check"></i><b>3.4.10</b> Reshaping Data from Long to Wide and Viceversa</a></li>
<li class="chapter" data-level="3.4.11" data-path="data-in-r.html"><a href="data-in-r.html#extending-the-basic-table-function"><i class="fa fa-check"></i><b>3.4.11</b> Extending the Basic <code>table()</code> Function</a></li>
<li class="chapter" data-level="3.4.12" data-path="data-in-r.html"><a href="data-in-r.html#merging-datasets"><i class="fa fa-check"></i><b>3.4.12</b> Merging Datasets</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="summarizing-data.html"><a href="summarizing-data.html"><i class="fa fa-check"></i><b>4</b> Summarizing Data</a><ul>
<li class="chapter" data-level="4.1" data-path="measures-of-central-tendency.html"><a href="measures-of-central-tendency.html"><i class="fa fa-check"></i><b>4.1</b> Measures of Central Tendency</a></li>
<li class="chapter" data-level="4.2" data-path="measures-of-dispersion.html"><a href="measures-of-dispersion.html"><i class="fa fa-check"></i><b>4.2</b> Measures of Dispersion</a></li>
<li class="chapter" data-level="4.3" data-path="histograms.html"><a href="histograms.html"><i class="fa fa-check"></i><b>4.3</b> Histograms</a></li>
<li class="chapter" data-level="4.4" data-path="empirical-cumulative-distribution-function.html"><a href="empirical-cumulative-distribution-function.html"><i class="fa fa-check"></i><b>4.4</b> Empirical Cumulative Distribution Function</a></li>
<li class="chapter" data-level="4.5" data-path="boxplots.html"><a href="boxplots.html"><i class="fa fa-check"></i><b>4.5</b> Boxplots</a></li>
<li class="chapter" data-level="4.6" data-path="covariance-and-correlation-coefficicent.html"><a href="covariance-and-correlation-coefficicent.html"><i class="fa fa-check"></i><b>4.6</b> Covariance and Correlation Coefficicent</a></li>
<li class="chapter" data-level="4.7" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>4.7</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="probability.html"><a href="probability.html"><i class="fa fa-check"></i><b>5</b> Probability</a><ul>
<li class="chapter" data-level="5.1" data-path="sample-spaces-outcomes-events-and-set-operations.html"><a href="sample-spaces-outcomes-events-and-set-operations.html"><i class="fa fa-check"></i><b>5.1</b> Sample Spaces, Outcomes, Events, and Set Operations</a></li>
<li class="chapter" data-level="5.2" data-path="probability-of-a-union.html"><a href="probability-of-a-union.html"><i class="fa fa-check"></i><b>5.2</b> Probability of a Union</a></li>
<li class="chapter" data-level="5.3" data-path="probability-of-an-intersection.html"><a href="probability-of-an-intersection.html"><i class="fa fa-check"></i><b>5.3</b> Probability of an Intersection</a></li>
<li class="chapter" data-level="5.4" data-path="conditional-probability.html"><a href="conditional-probability.html"><i class="fa fa-check"></i><b>5.4</b> Conditional Probability</a></li>
<li class="chapter" data-level="5.5" data-path="independence.html"><a href="independence.html"><i class="fa fa-check"></i><b>5.5</b> Independence</a><ul>
<li class="chapter" data-level="5.5.1" data-path="independence.html"><a href="independence.html#birthday-problem"><i class="fa fa-check"></i><b>5.5.1</b> Birthday Problem</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="law-of-total-probability-and-bayes-rule.html"><a href="law-of-total-probability-and-bayes-rule.html"><i class="fa fa-check"></i><b>5.6</b> Law of Total Probability and Bayes Rule</a></li>
<li class="chapter" data-level="5.7" data-path="combinatorial-methods.html"><a href="combinatorial-methods.html"><i class="fa fa-check"></i><b>5.7</b> Combinatorial Methods</a><ul>
<li class="chapter" data-level="5.7.1" data-path="combinatorial-methods.html"><a href="combinatorial-methods.html#permutations"><i class="fa fa-check"></i><b>5.7.1</b> Permutations</a></li>
<li class="chapter" data-level="5.7.2" data-path="combinatorial-methods.html"><a href="combinatorial-methods.html#combinations"><i class="fa fa-check"></i><b>5.7.2</b> Combinations</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="exercises-1.html"><a href="exercises-1.html"><i class="fa fa-check"></i><b>5.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="probability-distributions.html"><a href="probability-distributions.html"><i class="fa fa-check"></i><b>6</b> Probability Distributions</a><ul>
<li class="chapter" data-level="6.1" data-path="random-variables.html"><a href="random-variables.html"><i class="fa fa-check"></i><b>6.1</b> Random Variables</a><ul>
<li class="chapter" data-level="6.1.1" data-path="random-variables.html"><a href="random-variables.html#expected-value-and-variance"><i class="fa fa-check"></i><b>6.1.1</b> Expected Value and Variance</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="discrete-probability-distributions.html"><a href="discrete-probability-distributions.html"><i class="fa fa-check"></i><b>6.2</b> Discrete Probability Distributions</a><ul>
<li class="chapter" data-level="6.2.1" data-path="discrete-probability-distributions.html"><a href="discrete-probability-distributions.html#bernoulli-distribution"><i class="fa fa-check"></i><b>6.2.1</b> Bernoulli distribution</a></li>
<li class="chapter" data-level="6.2.2" data-path="discrete-probability-distributions.html"><a href="discrete-probability-distributions.html#binomial-distribution"><i class="fa fa-check"></i><b>6.2.2</b> Binomial distribution</a></li>
<li class="chapter" data-level="6.2.3" data-path="discrete-probability-distributions.html"><a href="discrete-probability-distributions.html#poisson-distribution"><i class="fa fa-check"></i><b>6.2.3</b> Poisson Distribution</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="continuous-distributions.html"><a href="continuous-distributions.html"><i class="fa fa-check"></i><b>6.3</b> Continuous distributions</a><ul>
<li class="chapter" data-level="6.3.1" data-path="continuous-distributions.html"><a href="continuous-distributions.html#uniform-distribution"><i class="fa fa-check"></i><b>6.3.1</b> Uniform distribution</a></li>
<li class="chapter" data-level="6.3.2" data-path="continuous-distributions.html"><a href="continuous-distributions.html#normal-distribution"><i class="fa fa-check"></i><b>6.3.2</b> Normal distribution</a></li>
<li class="chapter" data-level="6.3.3" data-path="continuous-distributions.html"><a href="continuous-distributions.html#t-distribution"><i class="fa fa-check"></i><b>6.3.3</b> <em>t</em>-Distribution</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="distribution-fitting.html"><a href="distribution-fitting.html"><i class="fa fa-check"></i><b>6.4</b> Distribution Fitting</a></li>
<li class="chapter" data-level="6.5" data-path="exercises-2.html"><a href="exercises-2.html"><i class="fa fa-check"></i><b>6.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="basic-multivariate-regression.html"><a href="basic-multivariate-regression.html"><i class="fa fa-check"></i><b>7</b> Basic Multivariate Regression</a><ul>
<li class="chapter" data-level="7.1" data-path="dummy-variables.html"><a href="dummy-variables.html"><i class="fa fa-check"></i><b>7.1</b> Dummy Variables</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="anova.html"><a href="anova.html"><i class="fa fa-check"></i><b>8</b> ANOVA</a><ul>
<li class="chapter" data-level="8.1" data-path="exercises-3.html"><a href="exercises-3.html"><i class="fa fa-check"></i><b>8.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="violating-assumptions.html"><a href="violating-assumptions.html"><i class="fa fa-check"></i><b>9</b> Violating Assumptions</a><ul>
<li class="chapter" data-level="9.1" data-path="heteroscedasticity.html"><a href="heteroscedasticity.html"><i class="fa fa-check"></i><b>9.1</b> Heteroscedasticity</a><ul>
<li class="chapter" data-level="9.1.1" data-path="heteroscedasticity.html"><a href="heteroscedasticity.html#detecting-heteroscedasticity"><i class="fa fa-check"></i><b>9.1.1</b> Detecting Heteroscedasticity</a></li>
<li class="chapter" data-level="9.1.2" data-path="heteroscedasticity.html"><a href="heteroscedasticity.html#correcting-heteroscedasticity"><i class="fa fa-check"></i><b>9.1.2</b> Correcting Heteroscedasticity</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="multicollinearity.html"><a href="multicollinearity.html"><i class="fa fa-check"></i><b>9.2</b> Multicollinearity</a><ul>
<li class="chapter" data-level="9.2.1" data-path="multicollinearity.html"><a href="multicollinearity.html#variance-inflated-factors-vif"><i class="fa fa-check"></i><b>9.2.1</b> Variance Inflated Factors (VIF)</a></li>
<li class="chapter" data-level="9.2.2" data-path="multicollinearity.html"><a href="multicollinearity.html#examples"><i class="fa fa-check"></i><b>9.2.2</b> Examples</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="other-issues-and-problems-with-data.html"><a href="other-issues-and-problems-with-data.html"><i class="fa fa-check"></i><b>9.3</b> Other Issues and Problems with Data</a></li>
<li class="chapter" data-level="9.4" data-path="autocorrelation.html"><a href="autocorrelation.html"><i class="fa fa-check"></i><b>9.4</b> Autocorrelation</a><ul>
<li class="chapter" data-level="9.4.1" data-path="autocorrelation.html"><a href="autocorrelation.html#durbin-watson-d-test"><i class="fa fa-check"></i><b>9.4.1</b> Durbin Watson d-Test</a></li>
<li class="chapter" data-level="9.4.2" data-path="autocorrelation.html"><a href="autocorrelation.html#breusch-godfrey-test"><i class="fa fa-check"></i><b>9.4.2</b> Breusch-Godfrey Test</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="exercises-4.html"><a href="exercises-4.html"><i class="fa fa-check"></i><b>9.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="binary-choice.html"><a href="binary-choice.html"><i class="fa fa-check"></i><b>10</b> Binary Choice</a><ul>
<li class="chapter" data-level="10.1" data-path="binary-choice-estimation-in-r.html"><a href="binary-choice-estimation-in-r.html"><i class="fa fa-check"></i><b>10.1</b> Binary Choice Estimation in R</a></li>
<li class="chapter" data-level="10.2" data-path="additional-examples-and-probit-model.html"><a href="additional-examples-and-probit-model.html"><i class="fa fa-check"></i><b>10.2</b> Additional Examples and Probit Model</a><ul>
<li class="chapter" data-level="10.2.1" data-path="additional-examples-and-probit-model.html"><a href="additional-examples-and-probit-model.html#full-time-work"><i class="fa fa-check"></i><b>10.2.1</b> Full-Time Work</a></li>
<li class="chapter" data-level="10.2.2" data-path="additional-examples-and-probit-model.html"><a href="additional-examples-and-probit-model.html#voting-behavior"><i class="fa fa-check"></i><b>10.2.2</b> Voting Behavior</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="exercises-5.html"><a href="exercises-5.html"><i class="fa fa-check"></i><b>10.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="qualitative-choice-models.html"><a href="qualitative-choice-models.html"><i class="fa fa-check"></i><b>11</b> Qualitative Choice Models</a><ul>
<li class="chapter" data-level="11.1" data-path="ordered-logit-model.html"><a href="ordered-logit-model.html"><i class="fa fa-check"></i><b>11.1</b> Ordered Logit Model</a><ul>
<li class="chapter" data-level="11.1.1" data-path="ordered-logit-model.html"><a href="ordered-logit-model.html#ordered-logit-example-organic-food-purchase"><i class="fa fa-check"></i><b>11.1.1</b> Ordered Logit Example: Organic Food Purchase</a></li>
<li class="chapter" data-level="11.1.2" data-path="ordered-logit-model.html"><a href="ordered-logit-model.html#predicted-probability-and-marginal-effects"><i class="fa fa-check"></i><b>11.1.2</b> Predicted Probability and Marginal Effects</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="multinomial-logit-and-multinomial-probit-models.html"><a href="multinomial-logit-and-multinomial-probit-models.html"><i class="fa fa-check"></i><b>11.2</b> Multinomial Logit and Multinomial Probit Models</a><ul>
<li class="chapter" data-level="11.2.1" data-path="multinomial-logit-and-multinomial-probit-models.html"><a href="multinomial-logit-and-multinomial-probit-models.html#theoretical-aspects"><i class="fa fa-check"></i><b>11.2.1</b> Theoretical Aspects</a></li>
<li class="chapter" data-level="11.2.2" data-path="multinomial-logit-and-multinomial-probit-models.html"><a href="multinomial-logit-and-multinomial-probit-models.html#data-managment"><i class="fa fa-check"></i><b>11.2.2</b> Data Managment</a></li>
<li class="chapter" data-level="11.2.3" data-path="multinomial-logit-and-multinomial-probit-models.html"><a href="multinomial-logit-and-multinomial-probit-models.html#fishing-data"><i class="fa fa-check"></i><b>11.2.3</b> Fishing Data</a></li>
<li class="chapter" data-level="11.2.4" data-path="multinomial-logit-and-multinomial-probit-models.html"><a href="multinomial-logit-and-multinomial-probit-models.html#travel-data"><i class="fa fa-check"></i><b>11.2.4</b> Travel Data</a></li>
<li class="chapter" data-level="11.2.5" data-path="multinomial-logit-and-multinomial-probit-models.html"><a href="multinomial-logit-and-multinomial-probit-models.html#electric-vehicle-data"><i class="fa fa-check"></i><b>11.2.5</b> Electric Vehicle Data</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="exercises-6.html"><a href="exercises-6.html"><i class="fa fa-check"></i><b>11.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="limited-dependent-variable-models.html"><a href="limited-dependent-variable-models.html"><i class="fa fa-check"></i><b>12</b> Limited Dependent Variable Models</a><ul>
<li class="chapter" data-level="12.1" data-path="truncation.html"><a href="truncation.html"><i class="fa fa-check"></i><b>12.1</b> Truncation</a></li>
<li class="chapter" data-level="12.2" data-path="censoring.html"><a href="censoring.html"><i class="fa fa-check"></i><b>12.2</b> Censoring</a></li>
<li class="chapter" data-level="12.3" data-path="count-regression-models.html"><a href="count-regression-models.html"><i class="fa fa-check"></i><b>12.3</b> Count Regression Models</a><ul>
<li class="chapter" data-level="12.3.1" data-path="count-regression-models.html"><a href="count-regression-models.html#poisson-regression-model"><i class="fa fa-check"></i><b>12.3.1</b> Poisson Regression Model</a></li>
<li class="chapter" data-level="12.3.2" data-path="count-regression-models.html"><a href="count-regression-models.html#quasi-poisson-regression-model"><i class="fa fa-check"></i><b>12.3.2</b> Quasi-Poisson Regression Model</a></li>
<li class="chapter" data-level="12.3.3" data-path="count-regression-models.html"><a href="count-regression-models.html#negative-binomial-regression-model"><i class="fa fa-check"></i><b>12.3.3</b> Negative Binomial Regression Model</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="hurdle-and-zero-inflation-models.html"><a href="hurdle-and-zero-inflation-models.html"><i class="fa fa-check"></i><b>12.4</b> Hurdle and Zero-Inflation Models</a></li>
<li class="chapter" data-level="12.5" data-path="survival-analysis.html"><a href="survival-analysis.html"><i class="fa fa-check"></i><b>12.5</b> Survival Analysis</a></li>
<li class="chapter" data-level="12.6" data-path="exercises-7.html"><a href="exercises-7.html"><i class="fa fa-check"></i><b>12.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="panel-data.html"><a href="panel-data.html"><i class="fa fa-check"></i><b>13</b> Panel Data</a><ul>
<li class="chapter" data-level="13.1" data-path="overview-1.html"><a href="overview-1.html"><i class="fa fa-check"></i><b>13.1</b> Overview</a></li>
<li class="chapter" data-level="13.2" data-path="pooled-ordinary-least-square-model.html"><a href="pooled-ordinary-least-square-model.html"><i class="fa fa-check"></i><b>13.2</b> Pooled Ordinary Least Square model</a></li>
<li class="chapter" data-level="13.3" data-path="fixed-effects-panel-data-model.html"><a href="fixed-effects-panel-data-model.html"><i class="fa fa-check"></i><b>13.3</b> Fixed Effects Panel Data Model</a></li>
<li class="chapter" data-level="13.4" data-path="random-effects-model.html"><a href="random-effects-model.html"><i class="fa fa-check"></i><b>13.4</b> Random Effects Model</a></li>
<li class="chapter" data-level="13.5" data-path="exercises-8.html"><a href="exercises-8.html"><i class="fa fa-check"></i><b>13.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="time-series.html"><a href="time-series.html"><i class="fa fa-check"></i><b>14</b> Time Series</a><ul>
<li class="chapter" data-level="14.1" data-path="trend-and-seasonality.html"><a href="trend-and-seasonality.html"><i class="fa fa-check"></i><b>14.1</b> Trend and Seasonality</a><ul>
<li class="chapter" data-level="14.1.1" data-path="trend-and-seasonality.html"><a href="trend-and-seasonality.html#practice-exercise"><i class="fa fa-check"></i><b>14.1.1</b> Practice Exercise</a></li>
</ul></li>
<li class="chapter" data-level="14.2" data-path="finite-distributed-lag-models.html"><a href="finite-distributed-lag-models.html"><i class="fa fa-check"></i><b>14.2</b> Finite Distributed Lag Models</a></li>
<li class="chapter" data-level="14.3" data-path="basic-theoretical-aspects-of-time-series.html"><a href="basic-theoretical-aspects-of-time-series.html"><i class="fa fa-check"></i><b>14.3</b> Basic Theoretical Aspects of Time Series</a></li>
<li class="chapter" data-level="14.4" data-path="autoregressive-model.html"><a href="autoregressive-model.html"><i class="fa fa-check"></i><b>14.4</b> Autoregressive Model</a></li>
<li class="chapter" data-level="14.5" data-path="moving-average-models.html"><a href="moving-average-models.html"><i class="fa fa-check"></i><b>14.5</b> Moving Average Models</a></li>
<li class="chapter" data-level="14.6" data-path="random-walk.html"><a href="random-walk.html"><i class="fa fa-check"></i><b>14.6</b> Random Walk</a></li>
<li class="chapter" data-level="14.7" data-path="forecasting-japanense-car-production.html"><a href="forecasting-japanense-car-production.html"><i class="fa fa-check"></i><b>14.7</b> Forecasting Japanense Car Production</a></li>
<li class="chapter" data-level="14.8" data-path="exercises-9.html"><a href="exercises-9.html"><i class="fa fa-check"></i><b>14.8</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="data-sources.html"><a href="data-sources.html"><i class="fa fa-check"></i><b>15</b> Data Sources</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Analysis for Public Affairs with R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="count-regression-models" class="section level2">
<h2><span class="header-section-number">12.3</span> Count Regression Models</h2>
<p>Count regression models apply to cases in which the dependent variable represents discrete, integer count data. Here are some examples of count outcomes:</p>
<ul>
<li>What are the number of arrests for a person?</li>
<li>What determines the number of credit cards a person owns?</li>
</ul>
<p>This section on count regression presents three models:</p>
<ol style="list-style-type: decimal">
<li>Poisson Regression Model: The condition to use this model is the absence of overdispersion, i.e., the expected value of the dependent variable is equal to the variance.</li>
<li>Quasi-Poisson Regression Model: Overdispersion occurs if the variance of the dependent variable is larger than its mean. In this case, the Poisson Regression Model leads to unreliable hypothesis tests regarding the coefficients. The Quasi-Poisson Model solves this issue.</li>
<li>Negative Binomial Regression Model: The second possibility to deal with overdispersion is to use a Negative Binomial Regression Model.</li>
</ol>
<p>The main package used is <a href="https://cran.r-project.org/web/packages/pscl/index.html">pscl</a>. There is also an additional resource with more theoretical details on the topic: <a href="http://dx.doi.org/10.18637/jss.v027.i08">Regression Models for Count Data in R</a>. A more up-to-date version of the document may be found with the <a href="https://cran.r-project.org/web/packages/pscl/index.html">pscl</a> package documentation.</p>
<div id="poisson-regression-model" class="section level3">
<h3><span class="header-section-number">12.3.1</span> Poisson Regression Model</h3>
<p>Recall that the Poisson distribution is written as:
<span class="math display">\[Pr(Y=k)=\frac{e^{-\lambda} \cdot \lambda^k}{k!}\]</span>
The important characteristics of the distribution is that the mean and variance are equal to <span class="math inline">\(\lambda\)</span>, i.e., <span class="math inline">\(E(Y)=\lambda\)</span> and <span class="math inline">\(Var(Y)=\lambda\)</span>, this is also known as the equidispersion property. The mean parameter is written as <span class="math inline">\(\lambda=exp(\beta_0+\beta_1 \cdot x_1+ \dots + \beta_k \cdot x_k)\)</span>.</p>
<p>The first examples uses the 2017 <a href="https://nhts.ornl.gov/">NHTS</a> data contained in <code>hhpub</code>. In a first step, the data is prepared for the regression model, i.e., missing or unknown values are eliminated and income is measured in (thousand) dollar terms:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="count-regression-models.html#cb100-1"></a>hhpubdata =<span class="st"> </span><span class="kw">subset</span>(hhpub,HHFAMINC <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">11</span>) <span class="op">&amp;</span><span class="st"> </span>HOMEOWN <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>) <span class="op">&amp;</span><span class="st"> </span>URBRUR <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>) <span class="op">&amp;</span><span class="st"> </span>HHVEHCNT <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">12</span>))</span>
<span id="cb100-2"><a href="count-regression-models.html#cb100-2"></a>HHFAMINC =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">11</span>)</span>
<span id="cb100-3"><a href="count-regression-models.html#cb100-3"></a>INCOME =<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>,<span class="fl">12.5</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="fl">42.5</span>,<span class="fl">57.5</span>,<span class="fl">82.5</span>,<span class="fl">112.5</span>,<span class="fl">137.5</span>,<span class="dv">175</span>,<span class="dv">200</span>)</span>
<span id="cb100-4"><a href="count-regression-models.html#cb100-4"></a>INCOME =<span class="st"> </span><span class="kw">data.frame</span>(HHFAMINC,INCOME)</span>
<span id="cb100-5"><a href="count-regression-models.html#cb100-5"></a>hhpubdata =<span class="st"> </span><span class="kw">merge</span>(hhpubdata,INCOME)</span>
<span id="cb100-6"><a href="count-regression-models.html#cb100-6"></a>hhpubdata<span class="op">$</span>RURAL =<span class="st"> </span>hhpubdata<span class="op">$</span>URBRUR<span class="dv">-1</span></span>
<span id="cb100-7"><a href="count-regression-models.html#cb100-7"></a>hhpubdata<span class="op">$</span>RENT =<span class="st"> </span>hhpubdata<span class="op">$</span>HOMEOWN<span class="dv">-1</span></span></code></pre></div>
<p>The outcome of interest is the number of vehicles based on household income, home ownership, and urban/rural household location. Before executing the Poisson regression model, calculate the mean and variance of the outcome variable.</p>
<pre><code>## [1] 1.981142</code></pre>
<pre><code>## [1] 1.386027</code></pre>
<p>The mean and the variance are similar and thus, estimating a Poisson Regression Model is an appropriate first step. The package <a href="https://cran.r-project.org/web/packages/AER/index.html">AER</a> also contains the function <code>dispersiontest()</code> which conducts a hypothesis test assuming no overdispersion. This test will be used after execution of the main regression. To estimate the model, the <code>glm()</code> function can be used by specifying <code>family=poisson</code>.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="count-regression-models.html#cb103-1"></a>bhat_pois =<span class="st"> </span><span class="kw">glm</span>(HHVEHCNT<span class="op">~</span>INCOME<span class="op">+</span>RENT<span class="op">+</span>RURAL,<span class="dt">data=</span>hhpubdata,<span class="dt">family=</span>poisson)</span>
<span id="cb103-2"><a href="count-regression-models.html#cb103-2"></a><span class="kw">summary</span>(bhat_pois)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = HHVEHCNT ~ INCOME + RENT + RURAL, family = poisson, 
##     data = hhpubdata)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.6889  -0.5568  -0.1558   0.3590   5.5063  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  4.654e-01  4.292e-03  108.43   &lt;2e-16 ***
## INCOME       2.986e-03  3.601e-05   82.93   &lt;2e-16 ***
## RENT        -3.733e-01  5.797e-03  -64.39   &lt;2e-16 ***
## RURAL        2.224e-01  4.616e-03   48.19   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 86505  on 124400  degrees of freedom
## Residual deviance: 68533  on 124397  degrees of freedom
## AIC: 370161
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>All coefficients are statistically significant. The signs associated with the coefficients indicates the direction of influence on the outcome variable, i.e., the number of cars. As expected, higher income is associated with a higher number of cars and so is living in a rural environment. Renting is associated with a lower number of vehicles. Note that income and renting is possibly correlated. In general, the coefficient estimates are interpreted using <span class="math inline">\(\exp(\beta)\)</span>. That is, with every unit increase in <span class="math inline">\(X\)</span>, the predictor variable has a multiplicative effect of <span class="math inline">\(\exp(\beta)\)</span> on the mean of <span class="math inline">\(Y\)</span>, i.e., <span class="math inline">\(\lambda\)</span>:</p>
<ul>
<li>If <span class="math inline">\(\beta=0\)</span>, then <span class="math inline">\(\exp(\beta) = 1\)</span>, and the expected count <span class="math inline">\(\mu= E(y) = \exp(\alpha)\)</span>, and Y and X are not related.</li>
<li>If <span class="math inline">\(\beta&gt;0\)</span>, then <span class="math inline">\(\exp(\beta) &gt; 1\)</span>, and the expected count <span class="math inline">\(E(y)\)</span> is <span class="math inline">\(\exp(\beta)\)</span> times larger than when <span class="math inline">\(X = 0\)</span></li>
<li>If <span class="math inline">\(\beta&lt;0\)</span>, then <span class="math inline">\(\exp(\beta) &lt; 1\)</span>, and the expected count <span class="math inline">\(E(y)\)</span> is <span class="math inline">\(\exp(\beta)\)</span> times smaller than when <span class="math inline">\(X = 0\)</span></li>
</ul>
<p>The function <code>overdispersion</code> tests the null hypothesis of equidispersion:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="count-regression-models.html#cb105-1"></a><span class="kw">dispersiontest</span>(bhat_pois)</span></code></pre></div>
<pre><code>## 
##  Overdispersion test
## 
## data:  bhat_pois
## z = -115.75, p-value = 1
## alternative hypothesis: true dispersion is greater than 1
## sample estimates:
## dispersion 
##  0.5670593</code></pre>
<p>Given the <em>p</em>-value, the null hypothesis cannot be rejected. If the data suggests overdispersion, two alternative regression models can be used: (1) Quasi-Poisson and (2) Negative Binomial.</p>
</div>
<div id="quasi-poisson-regression-model" class="section level3">
<h3><span class="header-section-number">12.3.2</span> Quasi-Poisson Regression Model</h3>
<p>The dataset <code>blm</code> used in this section as well as the one describing the negative binomial model is associated with the article <a href="https://doi.org/10.1017/S1537592717004273">Black Lives Matter: Evidence that Police-Caused Deaths Predict Protest Activity</a>. Note that the paper includes a significant number of supplementary materials which allows for the replication of the results and much more.</p>
<p>The dependent variable is the total number of protests in a city. In a first step, the mean and variance of the variable <span class="math inline">\(totalprotests\)</span> are calclated:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="count-regression-models.html#cb107-1"></a><span class="kw">mean</span>(blm<span class="op">$</span>totprotests)</span></code></pre></div>
<pre><code>## [1] 0.4959529</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="count-regression-models.html#cb109-1"></a><span class="kw">var</span>(blm<span class="op">$</span>totprotests)</span></code></pre></div>
<pre><code>## [1] 6.35326</code></pre>
<p>The variance is significantly higher than the mean which suggests overdispersion. In a first step, a regular Poisson model is estimated.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="count-regression-models.html#cb111-1"></a>eq1 =<span class="st"> &quot;totprotests~log(pop)+log(popdensity)+percentblack+blackpovertyrate+I(blackpovertyrate^2)+percentbachelor+collegeenrollpc+demshare&quot;</span></span>
<span id="cb111-2"><a href="count-regression-models.html#cb111-2"></a>bhat1 =<span class="st"> </span><span class="kw">glm</span>(eq1,<span class="dt">data=</span>blm,<span class="dt">family=</span>poisson)</span>
<span id="cb111-3"><a href="count-regression-models.html#cb111-3"></a><span class="kw">summary</span>(bhat1)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = eq1, family = poisson, data = blm)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -4.6571  -0.5238  -0.3008  -0.1632   6.5795  
## 
## Coefficients:
##                         Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)           -2.001e+01  6.327e-01 -31.625  &lt; 2e-16 ***
## log(pop)               1.129e+00  4.007e-02  28.170  &lt; 2e-16 ***
## log(popdensity)       -1.831e-01  8.654e-02  -2.116   0.0343 *  
## percentblack           1.697e-02  3.104e-03   5.467 4.59e-08 ***
## blackpovertyrate       1.461e-01  2.636e-02   5.541 3.02e-08 ***
## I(blackpovertyrate^2) -1.552e-03  3.985e-04  -3.895 9.82e-05 ***
## percentbachelor        3.893e-02  3.918e-03   9.935  &lt; 2e-16 ***
## collegeenrollpc        9.305e-03  2.377e-03   3.914 9.06e-05 ***
## demshare               4.301e-02  5.293e-03   8.126 4.43e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 3204.6  on 1225  degrees of freedom
## Residual deviance:  787.4  on 1217  degrees of freedom
##   (133 observations deleted due to missingness)
## AIC: 1242.9
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<p>Note that the signs and statistical significance correspond to Model 1 (Table 3) in the original paper. The coefficients are different because the paper only include negative binomial regression models. The reason for not using a Poisson regression model is the presence of overdispersion:</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="count-regression-models.html#cb113-1"></a><span class="kw">dispersiontest</span>(bhat1)</span></code></pre></div>
<pre><code>## 
##  Overdispersion test
## 
## data:  bhat1
## z = 1.4052, p-value = 0.07998
## alternative hypothesis: true dispersion is greater than 1
## sample estimates:
## dispersion 
##   2.212733</code></pre>
<p>Note that the null hypothesis is rejected at the 10% but not the 5% significance level. The Quasi-Poisson Regression Model handles overdispersion by adjusting the stand-errors but leaving the coefficicent estimates the same.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="count-regression-models.html#cb115-1"></a>bhat2 =<span class="st"> </span><span class="kw">glm</span>(eq1,<span class="dt">data=</span>blm,<span class="dt">family=</span>quasipoisson)</span>
<span id="cb115-2"><a href="count-regression-models.html#cb115-2"></a><span class="kw">summary</span>(bhat2)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = eq1, family = quasipoisson, data = blm)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -4.6571  -0.5238  -0.3008  -0.1632   6.5795  
## 
## Coefficients:
##                         Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           -2.001e+01  9.841e-01 -20.332  &lt; 2e-16 ***
## log(pop)               1.129e+00  6.232e-02  18.111  &lt; 2e-16 ***
## log(popdensity)       -1.831e-01  1.346e-01  -1.360 0.173942    
## percentblack           1.697e-02  4.828e-03   3.515 0.000457 ***
## blackpovertyrate       1.461e-01  4.100e-02   3.562 0.000382 ***
## I(blackpovertyrate^2) -1.552e-03  6.198e-04  -2.504 0.012403 *  
## percentbachelor        3.893e-02  6.094e-03   6.387 2.40e-10 ***
## collegeenrollpc        9.305e-03  3.697e-03   2.517 0.011975 *  
## demshare               4.301e-02  8.233e-03   5.225 2.05e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for quasipoisson family taken to be 2.419275)
## 
##     Null deviance: 3204.6  on 1225  degrees of freedom
## Residual deviance:  787.4  on 1217  degrees of freedom
##   (133 observations deleted due to missingness)
## AIC: NA
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<p>Note that in this case, the population density is not statistically significant anymore.</p>
</div>
<div id="negative-binomial-regression-model" class="section level3">
<h3><span class="header-section-number">12.3.3</span> Negative Binomial Regression Model</h3>
<p>The Negative Binomial Regression Model can be used in the presence of count data and overdispersion. Below, the results from the article <a href="https://doi.org/10.1017/S1537592717004273">Black Lives Matter: Evidence that Police-Caused Deaths Predict Protest Activity</a> are recreated using the negative binomial models presented in the paper. The required package is <a href="https://cran.r-project.org/web/packages/MASS/index.html">MASS</a></p>
<p>The first model is a basic model of resource mobilization and opportunity structure.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="count-regression-models.html#cb117-1"></a>bhat3 =<span class="st"> </span><span class="kw">glm.nb</span>(eq1,<span class="dt">data=</span>blm,<span class="dt">link=</span>log)</span>
<span id="cb117-2"><a href="count-regression-models.html#cb117-2"></a><span class="kw">summary</span>(bhat3) </span></code></pre></div>
<pre><code>## 
## Call:
## glm.nb(formula = eq1, data = blm, link = log, init.theta = 1.559078735)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.2523  -0.4543  -0.2673  -0.1506   5.7386  
## 
## Coefficients:
##                         Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)           -2.090e+01  1.117e+00 -18.719  &lt; 2e-16 ***
## log(pop)               1.292e+00  7.159e-02  18.047  &lt; 2e-16 ***
## log(popdensity)       -3.130e-01  1.328e-01  -2.356  0.01848 *  
## percentblack           2.249e-02  4.709e-03   4.777 1.78e-06 ***
## blackpovertyrate       1.319e-01  3.121e-02   4.227 2.37e-05 ***
## I(blackpovertyrate^2) -1.340e-03  4.768e-04  -2.810  0.00496 ** 
## percentbachelor        4.462e-02  5.465e-03   8.163 3.26e-16 ***
## collegeenrollpc        1.051e-02  4.118e-03   2.553  0.01068 *  
## demshare               4.077e-02  7.292e-03   5.591 2.26e-08 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Negative Binomial(1.5591) family taken to be 1)
## 
##     Null deviance: 1899.84  on 1225  degrees of freedom
## Residual deviance:  501.15  on 1217  degrees of freedom
##   (133 observations deleted due to missingness)
## AIC: 1120.2
## 
## Number of Fisher Scoring iterations: 1
## 
## 
##               Theta:  1.559 
##           Std. Err.:  0.351 
## 
##  2 x log-likelihood:  -1100.187</code></pre>
<p>In a second model, black deaths are added:</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="count-regression-models.html#cb119-1"></a>bhat4 =<span class="st"> </span><span class="kw">glm.nb</span>(totprotests<span class="op">~</span><span class="kw">log</span>(pop)<span class="op">+</span><span class="kw">log</span>(popdensity)<span class="op">+</span>percentblack<span class="op">+</span>blackpovertyrate<span class="op">+</span><span class="kw">I</span>(blackpovertyrate<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span>percentbachelor<span class="op">+</span>collegeenrollpc<span class="op">+</span>demshare<span class="op">+</span>deathsblackpc,<span class="dt">data=</span>blm,<span class="dt">link=</span>log)</span>
<span id="cb119-2"><a href="count-regression-models.html#cb119-2"></a><span class="kw">summary</span>(bhat4) </span></code></pre></div>
<pre><code>## 
## Call:
## glm.nb(formula = totprotests ~ log(pop) + log(popdensity) + percentblack + 
##     blackpovertyrate + I(blackpovertyrate^2) + percentbachelor + 
##     collegeenrollpc + demshare + deathsblackpc, data = blm, link = log, 
##     init.theta = 1.685551835)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.3170  -0.4549  -0.2707  -0.1529   5.3090  
## 
## Coefficients:
##                         Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)           -2.073e+01  1.101e+00 -18.824  &lt; 2e-16 ***
## log(pop)               1.281e+00  7.046e-02  18.178  &lt; 2e-16 ***
## log(popdensity)       -3.054e-01  1.315e-01  -2.323 0.020201 *  
## percentblack           1.801e-02  4.864e-03   3.704 0.000212 ***
## blackpovertyrate       1.283e-01  3.109e-02   4.127 3.67e-05 ***
## I(blackpovertyrate^2) -1.301e-03  4.743e-04  -2.744 0.006071 ** 
## percentbachelor        4.372e-02  5.381e-03   8.125 4.47e-16 ***
## collegeenrollpc        1.005e-02  4.073e-03   2.466 0.013657 *  
## demshare               4.069e-02  7.249e-03   5.613 1.98e-08 ***
## deathsblackpc          2.825e+00  9.312e-01   3.034 0.002414 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Negative Binomial(1.6856) family taken to be 1)
## 
##     Null deviance: 1943.21  on 1225  degrees of freedom
## Residual deviance:  500.18  on 1216  degrees of freedom
##   (133 observations deleted due to missingness)
## AIC: 1113.4
## 
## Number of Fisher Scoring iterations: 1
## 
## 
##               Theta:  1.686 
##           Std. Err.:  0.404 
## 
##  2 x log-likelihood:  -1091.353</code></pre>
<p>And in the third model, the authors use all police-caused deaths instead (victims of any race):</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="count-regression-models.html#cb121-1"></a>bhat5 =<span class="st"> </span><span class="kw">glm.nb</span>(totprotests<span class="op">~</span><span class="kw">log</span>(pop)<span class="op">+</span><span class="kw">log</span>(popdensity)<span class="op">+</span>percentblack<span class="op">+</span>blackpovertyrate<span class="op">+</span><span class="kw">I</span>(blackpovertyrate<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span>percentbachelor<span class="op">+</span>collegeenrollpc<span class="op">+</span>demshare<span class="op">+</span>deathspc,<span class="dt">data=</span>blm,<span class="dt">link=</span>log)</span>
<span id="cb121-2"><a href="count-regression-models.html#cb121-2"></a><span class="kw">summary</span>(bhat5) </span></code></pre></div>
<pre><code>## 
## Call:
## glm.nb(formula = totprotests ~ log(pop) + log(popdensity) + percentblack + 
##     blackpovertyrate + I(blackpovertyrate^2) + percentbachelor + 
##     collegeenrollpc + demshare + deathspc, data = blm, link = log, 
##     init.theta = 1.621799986)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.3230  -0.4517  -0.2684  -0.1505   5.6311  
## 
## Coefficients:
##                         Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)           -2.080e+01  1.108e+00 -18.773  &lt; 2e-16 ***
## log(pop)               1.277e+00  7.122e-02  17.928  &lt; 2e-16 ***
## log(popdensity)       -3.121e-01  1.321e-01  -2.363  0.01812 *  
## percentblack           2.163e-02  4.705e-03   4.596 4.31e-06 ***
## blackpovertyrate       1.295e-01  3.110e-02   4.164 3.12e-05 ***
## I(blackpovertyrate^2) -1.315e-03  4.744e-04  -2.772  0.00558 ** 
## percentbachelor        4.507e-02  5.472e-03   8.237  &lt; 2e-16 ***
## collegeenrollpc        1.040e-02  4.094e-03   2.540  0.01108 *  
## demshare               4.121e-02  7.257e-03   5.678 1.36e-08 ***
## deathspc               9.564e-01  6.330e-01   1.511  0.13085    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for Negative Binomial(1.6218) family taken to be 1)
## 
##     Null deviance: 1921.82  on 1225  degrees of freedom
## Residual deviance:  502.82  on 1216  degrees of freedom
##   (133 observations deleted due to missingness)
## AIC: 1119.8
## 
## Number of Fisher Scoring iterations: 1
## 
## 
##               Theta:  1.622 
##           Std. Err.:  0.374 
## 
##  2 x log-likelihood:  -1097.839</code></pre>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="censoring.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="hurdle-and-zero-inflation-models.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jrfdumortier/dataanalysis/edit/master/limiteddepvar.rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/jrfdumortier/dataanalysis/blob/master/limiteddepvar.rmd",
"text": null
},
"download": ["bookdownproj.pdf"],
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
